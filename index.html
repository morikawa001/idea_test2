<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åŒ»ç™‚ã‚’ã‚ˆãã™ã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢ï¼†ãŠå›°ã‚Šã”ã¨ææ¡ˆãƒ•ã‚©ãƒ¼ãƒ </title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
  background: #f0f4f8;
  color: #333;
  padding: 20px;
  min-height: 100vh;
}
.container { max-width: 720px; margin: 0 auto; }

.header {
  background: linear-gradient(135deg, #1a5276, #2e86c1);
  color: white;
  padding: 24px 28px;
  border-radius: 12px 12px 0 0;
  text-align: center;
}
.header h1 { font-size: 1.4em; margin-bottom: 6px; }
.header p  { font-size: 0.85em; opacity: 0.88; }

.stepper {
  display: flex;
  background: white;
  padding: 14px 20px;
  gap: 4px;
  align-items: center;
  border-bottom: 1px solid #d6eaf8;
  overflow-x: auto;
}
.step-dot {
  display: flex; flex-direction: column; align-items: center;
  gap: 4px; flex: 1; min-width: 44px;
}
.step-circle {
  width: 30px; height: 30px;
  border-radius: 50%;
  background: #d6eaf8;
  color: #7fb3d3;
  display: flex; align-items: center; justify-content: center;
  font-size: 0.75em; font-weight: bold;
  transition: all 0.4s;
}
.step-circle.done   { background: #27ae60; color: white; }
.step-circle.active { background: #2e86c1; color: white; box-shadow: 0 0 0 4px #aed6f1; }
.step-label { font-size: 0.65em; color: #888; text-align: center; }
.step-label.active { color: #1a5276; font-weight: bold; }
.step-line { height: 2px; background: #d6eaf8; flex: 0.3; border-radius: 1px; }
.step-line.done { background: #27ae60; }

.progress-bar-wrap {
  background: #eaf4fb;
  padding: 8px 20px;
  display: flex; align-items: center; gap: 10px;
  font-size: 0.82em; color: #1a5276;
}
.progress-bar-bg {
  flex: 1; height: 8px;
  background: #aed6f1; border-radius: 4px; overflow: hidden;
}
.progress-bar-fill {
  height: 100%; width: 0%;
  background: linear-gradient(90deg, #2e86c1, #27ae60);
  border-radius: 4px; transition: width 0.5s ease;
}

.navigator {
  display: flex; align-items: flex-start; gap: 12px;
  background: white;
  padding: 16px 20px;
  border-bottom: 1px solid #eaf4fb;
  animation: fadeSlideIn 0.4s ease;
}
.nav-avatar {
  font-size: 2.2em; flex-shrink: 0;
  animation: bounce 1s ease infinite alternate;
}
@keyframes bounce {
  from { transform: translateY(0); }
  to   { transform: translateY(-4px); }
}
.nav-bubble {
  background: #eaf4fb;
  border-radius: 0 12px 12px 12px;
  padding: 10px 14px;
  font-size: 0.88em;
  line-height: 1.6;
  color: #1a5276;
  position: relative;
  flex: 1;
}
.nav-bubble::before {
  content: '';
  position: absolute; left: -8px; top: 10px;
  border: 8px solid transparent;
  border-right-color: #eaf4fb;
  border-left: 0;
}

.block {
  background: white;
  border-left: 5px solid #2e86c1;
  border-radius: 0 0 8px 8px;
  padding: 24px 28px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.07);
  display: none;
  animation: fadeSlideIn 0.45s ease;
}
.block.active { display: block; }
@keyframes fadeSlideIn {
  from { opacity: 0; transform: translateY(18px); }
  to   { opacity: 1; transform: translateY(0); }
}

.block-title {
  font-size: 1.05em; font-weight: bold;
  color: #1a5276; margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 2px solid #d6eaf8;
  display: flex; align-items: center; gap: 8px;
}
.block-title .badge {
  font-size: 0.72em; background: #2e86c1; color: white;
  padding: 2px 10px; border-radius: 10px;
}

.q-block { margin-bottom: 24px; }
.q-label {
  font-size: 0.93em; font-weight: bold;
  margin-bottom: 6px; display: block; color: #2c3e50;
}
.q-label .req { color: #e74c3c; font-size: 0.82em; margin-left: 4px; }
.q-hint { font-size: 0.79em; color: #888; margin-bottom: 8px; }

.feedback-box {
  margin-top: 8px; padding: 8px 12px;
  border-radius: 6px; font-size: 0.82em;
  line-height: 1.5; min-height: 0;
  transition: all 0.3s; display: none;
}
.feedback-box.show { display: block; }
.feedback-good    { background: #eafaf1; color: #1e8449; border-left: 3px solid #27ae60; }
.feedback-neutral { background: #fef9e7; color: #9a7d0a; border-left: 3px solid #f1c40f; }
.feedback-tip     { background: #eaf4fb; color: #1a5276; border-left: 3px solid #2e86c1; }

select, input[type="text"], textarea {
  width: 100%; padding: 10px 13px;
  border: 1.5px solid #bdc3c7; border-radius: 7px;
  font-size: 0.92em; font-family: inherit;
  background: #fdfefe; transition: border 0.2s, box-shadow 0.2s;
}
select:focus, input:focus, textarea:focus {
  outline: none; border-color: #2e86c1;
  background: #eaf4fb; box-shadow: 0 0 0 3px rgba(46,134,193,0.12);
}
textarea { resize: vertical; min-height: 80px; }

.radio-group, .check-group {
  display: flex; flex-direction: column; gap: 8px;
}
.radio-group label, .check-group label {
  display: flex; align-items: flex-start; gap: 10px;
  font-size: 0.90em; cursor: pointer;
  padding: 9px 14px;
  border: 1.5px solid #d5d8dc; border-radius: 8px;
  transition: all 0.2s; background: #fdfefe;
}
.radio-group label:hover, .check-group label:hover { background: #eaf4fb; border-color: #aed6f1; }
.radio-group label.selected, .check-group label.selected {
  background: #eaf4fb; border-color: #2e86c1;
  box-shadow: 0 0 0 2px rgba(46,134,193,0.15);
}
.radio-group input, .check-group input { margin-top: 2px; accent-color: #2e86c1; flex-shrink: 0; }

.other-input-wrap {
  display: none;
  margin-top: 8px;
  padding: 10px 14px;
  background: #f7fbff;
  border-radius: 6px;
  border: 1.5px dashed #aed6f1;
  animation: fadeSlideIn 0.3s ease;
}
.other-input-wrap.show { display: block; }
.other-input-wrap textarea {
  min-height: 60px;
  background: white;
}

.nav-btn-row {
  display: flex; gap: 12px;
  justify-content: space-between;
  margin-top: 28px; flex-wrap: wrap;
}
.btn-prev    { background: #d5d8dc; color: #555; }
.btn-next    { background: #2e86c1; color: white; flex: 1; }
.btn-preview { background: #148f77; color: white; flex: 1; }
.btn-reset   { background: #aab7b8; color: white; }
button {
  padding: 12px 22px; border: none; border-radius: 8px;
  font-size: 0.95em; font-weight: bold; cursor: pointer;
  font-family: inherit; transition: opacity 0.2s, transform 0.1s;
}
button:hover  { opacity: 0.88; }
button:active { transform: scale(0.97); }

.check-anim {
  display: inline-block;
  animation: popIn 0.4s cubic-bezier(0.175,0.885,0.32,1.275);
}
@keyframes popIn {
  0%   { transform: scale(0); opacity: 0; }
  80%  { transform: scale(1.3); }
  100% { transform: scale(1); opacity: 1; }
}

/* ============================================================
   ãƒ¢ãƒ¼ãƒ€ãƒ«å…±é€š
============================================================ */
.modal-overlay {
  display: none; position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.55); z-index: 1000;
  align-items: center; justify-content: center;
}
.modal-overlay.active { display: flex; }
.modal {
  background: white; border-radius: 14px;
  padding: 28px; max-width: 640px; width: 94%;
  max-height: 88vh; overflow-y: auto;
  box-shadow: 0 10px 40px rgba(0,0,0,0.22);
  animation: fadeSlideIn 0.35s ease;
}
.modal h2 { color: #1a5276; margin-bottom: 12px; font-size: 1.1em; }
.modal pre {
  background: #f4f6f7; padding: 14px; border-radius: 8px;
  font-size: 0.81em; white-space: pre-wrap; line-height: 1.75;
  font-family: 'Courier New', monospace; border: 1px solid #d5d8dc;
}
.modal-btn-row { display: flex; gap: 10px; margin-top: 16px; flex-wrap: wrap; }
.btn-mail  { background: #2e86c1; color: white; }
.btn-dl    { background: #148f77; color: white; }
.btn-close { background: #aab7b8; color: white; }

/* ============================================================
   â–¼â–¼â–¼ æ„Ÿè¬ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆæ–°è¦è¿½åŠ ï¼‰
============================================================ */
.thank-modal-overlay {
  display: none; position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.60); z-index: 2000;
  align-items: center; justify-content: center;
}
.thank-modal-overlay.active { display: flex; }
.thank-modal {
  background: white; border-radius: 20px;
  padding: 44px 36px; max-width: 440px; width: 92%;
  text-align: center;
  box-shadow: 0 12px 48px rgba(0,0,0,0.25);
  animation: thankPop 0.5s cubic-bezier(0.175,0.885,0.32,1.275);
}
@keyframes thankPop {
  0%   { opacity: 0; transform: scale(0.7); }
  80%  { transform: scale(1.04); }
  100% { opacity: 1; transform: scale(1); }
}
.thank-icon {
  font-size: 4em;
  margin-bottom: 16px;
  animation: iconBounce 0.6s 0.3s cubic-bezier(0.175,0.885,0.32,1.275) both;
}
@keyframes iconBounce {
  0%   { transform: scale(0) rotate(-20deg); opacity: 0; }
  80%  { transform: scale(1.2) rotate(5deg); }
  100% { transform: scale(1) rotate(0deg); opacity: 1; }
}
.thank-title {
  font-size: 1.45em; font-weight: bold;
  color: #1a5276; margin-bottom: 12px;
}
.thank-body {
  font-size: 0.92em; color: #555;
  line-height: 1.8; margin-bottom: 28px;
}
.thank-body strong { color: #2e86c1; }
.thank-btn-row {
  display: flex; flex-direction: column; gap: 10px;
}
.btn-new-idea {
  background: linear-gradient(135deg, #1a5276, #2e86c1);
  color: white; padding: 13px 20px;
  border: none; border-radius: 10px;
  font-size: 0.95em; font-weight: bold;
  cursor: pointer; font-family: inherit;
  transition: opacity 0.2s, transform 0.1s;
}
.btn-new-idea:hover  { opacity: 0.88; }
.btn-new-idea:active { transform: scale(0.97); }
.btn-just-close {
  background: #ecf0f1; color: #777;
  padding: 10px 20px;
  border: none; border-radius: 10px;
  font-size: 0.88em; cursor: pointer; font-family: inherit;
  transition: opacity 0.2s;
}
.btn-just-close:hover { opacity: 0.75; }
/* â–²â–²â–² æ„Ÿè¬ãƒ¢ãƒ¼ãƒ€ãƒ«ã“ã“ã¾ã§ â–²â–²â–² */

@media(max-width:600px){
  .nav-btn-row { flex-direction: column; }
  button { width: 100%; }
  .stepper { gap: 2px; padding: 10px 8px; }
  .step-label { font-size: 0.58em; }
}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>ğŸ’¡ åŒ»ç™‚ã‚’ã‚ˆãã™ã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢ï¼†ãŠå›°ã‚Šã”ã¨ææ¡ˆãƒ•ã‚©ãƒ¼ãƒ </h1>
    <p>ç¾å ´ã®æ°—ã¥ãã‚„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ã‚«ã‚¿ãƒã«ã—ã¾ã™ã€‚3ã€œ5åˆ†ã§å…¥åŠ›ã§ãã¾ã™ã€‚</p>
  </div>

  <div class="stepper" id="stepper">
    <div class="step-dot">
      <div class="step-circle active" id="sc0">1</div>
      <div class="step-label active" id="sl0">åŸºæœ¬æƒ…å ±</div>
    </div>
    <div class="step-line" id="line0"></div>
    <div class="step-dot">
      <div class="step-circle" id="sc1">2</div>
      <div class="step-label" id="sl1">ç¾å ´ã®èª²é¡Œ</div>
    </div>
    <div class="step-line" id="line1"></div>
    <div class="step-dot">
      <div class="step-circle" id="sc2">3</div>
      <div class="step-label" id="sl2">ç¾çŠ¶ã®å¯¾å¿œ</div>
    </div>
    <div class="step-line" id="line2"></div>
    <div class="step-dot">
      <div class="step-circle" id="sc3">4</div>
      <div class="step-label" id="sl3">ã‚¢ã‚¤ãƒ‡ã‚¢</div>
    </div>
    <div class="step-line" id="line3"></div>
    <div class="step-dot">
      <div class="step-circle" id="sc4">5</div>
      <div class="step-label" id="sl4">æœŸå¾…åŠ¹æœ</div>
    </div>
  </div>

  <div class="progress-bar-wrap">
    <span id="progress-label">0 / 13 é …ç›®å…¥åŠ›æ¸ˆã¿</span>
    <div class="progress-bar-bg">
      <div class="progress-bar-fill" id="progressFill"></div>
    </div>
  </div>

  <div class="navigator">
    <div class="nav-avatar">ğŸ¤–</div>
    <div class="nav-bubble" id="navBubble">
      ã“ã‚“ã«ã¡ã¯ï¼ç¾å ´ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„ãŠå›°ã‚Šã”ã¨ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚<br>
      ã¾ãšã€<strong>ã‚ãªãŸã®åŸºæœ¬æƒ…å ±</strong>ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚æ°—è»½ã«å…¥åŠ›ã—ã¦ãã ã•ã„ğŸ˜Š
    </div>
  </div>

  <form id="ideaForm" novalidate>

    <!-- ã‚¹ãƒ†ãƒƒãƒ—1ï¼šåŸºæœ¬æƒ…å ± -->
    <div class="block active" id="step0">
      <div class="block-title">ğŸ“‹ ç¬¬1ã‚¹ãƒ†ãƒƒãƒ—ï¼šåŸºæœ¬æƒ…å ±</div>
      <div class="q-block">
        <label class="q-label">Q1. æ‰€å±éƒ¨ç½² <span class="req">â˜…å¿…é ˆ</span></label>
        <select id="q1" required onchange="onSelectChange('q1')">
          <option value="">-- é¸æŠã—ã¦ãã ã•ã„ --</option>
          <option>GICU</option><option>æ‰‹è¡“å®¤</option><option>å¤–æ¥</option>
          <option>ç—…æ£Ÿ</option><option>ãƒªãƒãƒ“ãƒªãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç§‘</option><option>è–¬å‰¤éƒ¨</option>
          <option>æ”¾å°„ç·šç§‘</option><option>è‡¨åºŠæ¤œæŸ»éƒ¨</option>
          <option>åŒ»ç™‚æƒ…å ±ãƒ»ã‚·ã‚¹ãƒ†ãƒ éƒ¨é–€</option><option>è‡¨åºŠç ”ç©¶æ”¯æ´ã‚»ãƒ³ã‚¿ãƒ¼</option>
          <option>äº‹å‹™éƒ¨é–€</option><option>ãã®ä»–</option>
        </select>
        <div class="feedback-box feedback-good" id="fb-q1"></div>
      </div>
      <div class="q-block">
        <label class="q-label">Q2. æ°å <span class="req">â˜…å¿…é ˆ</span></label>
        <input type="text" id="q2" placeholder="ä¾‹ï¼šå±±ç”° å¤ªéƒï¼ˆåŒ¿åå¸Œæœ›ã®å ´åˆã¯ã€ŒåŒ¿åã€ã¨å…¥åŠ›å¯ï¼‰"
               oninput="onTextInput('q2')" required>
        <div class="feedback-box" id="fb-q2"></div>
      </div>
      <div class="q-block">
        <label class="q-label">Q3. è·ç¨® <span class="req">â˜…å¿…é ˆ</span></label>
        <div class="radio-group" id="q3">
          <label><input type="radio" name="q3" value="åŒ»å¸«" onchange="onRadioChange('q3')"> åŒ»å¸«</label>
          <label><input type="radio" name="q3" value="çœ‹è­·å¸«" onchange="onRadioChange('q3')"> çœ‹è­·å¸«</label>
          <label><input type="radio" name="q3" value="è–¬å‰¤å¸«" onchange="onRadioChange('q3')"> è–¬å‰¤å¸«</label>
          <label><input type="radio" name="q3" value="è‡¨åºŠå·¥å­¦æŠ€å£«" onchange="onRadioChange('q3')"> è‡¨åºŠå·¥å­¦æŠ€å£«</label>
          <label><input type="radio" name="q3" value="ç†å­¦ç™‚æ³•å£«ãƒ»ä½œæ¥­ç™‚æ³•å£«" onchange="onRadioChange('q3')"> ç†å­¦ç™‚æ³•å£«ãƒ»ä½œæ¥­ç™‚æ³•å£«</label>
          <label><input type="radio" name="q3" value="äº‹å‹™è·" onchange="onRadioChange('q3')"> äº‹å‹™è·</label>
          <label><input type="radio" name="q3" value="ãã®ä»–" onchange="onRadioChange('q3')"> ãã®ä»–</label>
        </div>
        <div class="feedback-box" id="fb-q3"></div>
      </div>
      <div class="nav-btn-row">
        <button type="button" class="btn-next" onclick="goNext(0)">æ¬¡ã¸ï¼šç¾å ´ã®èª²é¡Œ â†’</button>
      </div>
    </div>

    <!-- ã‚¹ãƒ†ãƒƒãƒ—2ï¼šç¾å ´ã®èª²é¡Œ -->
    <div class="block" id="step1">
      <div class="block-title">ğŸ” ç¬¬2ã‚¹ãƒ†ãƒƒãƒ—ï¼šç¾å ´ã®èª²é¡Œ <span class="badge">Pï¼šå¯¾è±¡ãƒ»èƒŒæ™¯</span></div>
      <div class="q-block">
        <label class="q-label">Q4. èª°ãŒä¸€ç•ªå›°ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ <span class="req">â˜…å¿…é ˆ</span></label>
        <div class="radio-group" id="q4">
          <label><input type="radio" name="q4" value="æ‚£è€…ã•ã‚“" onchange="onRadioChange('q4')"> æ‚£è€…ã•ã‚“</label>
          <label><input type="radio" name="q4" value="è‡ªåˆ†è‡ªèº«ãƒ»è‡ªéƒ¨ç½²ã®ã‚¹ã‚¿ãƒƒãƒ•" onchange="onRadioChange('q4')"> è‡ªåˆ†è‡ªèº«ãƒ»è‡ªéƒ¨ç½²ã®ã‚¹ã‚¿ãƒƒãƒ•</label>
          <label><input type="radio" name="q4" value="ä»–éƒ¨ç½²ã®ã‚¹ã‚¿ãƒƒãƒ•" onchange="onRadioChange('q4')"> ä»–éƒ¨ç½²ã®ã‚¹ã‚¿ãƒƒãƒ•</label>
          <label><input type="radio" name="q4" value="ç—…é™¢å…¨ä½“" onchange="onRadioChange('q4')"> ç—…é™¢å…¨ä½“</label>
        </div>
        <div class="feedback-box" id="fb-q4"></div>
      </div>
      <div class="q-block">
        <label class="q-label">Q5. å›°ã‚Šã”ã¨ã®ç™ºç”Ÿé »åº¦ã¯ï¼Ÿ <span class="req">â˜…å¿…é ˆ</span></label>
        <div class="radio-group" id="q5">
          <label><input type="radio" name="q5" value="æ¯æ—¥è¤‡æ•°å›" onchange="onRadioChange('q5')"> æ¯æ—¥è¤‡æ•°å›</label>
          <label><input type="radio" name="q5" value="æ¯æ—¥1å›ç¨‹åº¦" onchange="onRadioChange('q5')"> æ¯æ—¥1å›ç¨‹åº¦</label>
          <label><input type="radio" name="q5" value="é€±ã«æ•°å›" onchange="onRadioChange('q5')"> é€±ã«æ•°å›</label>
          <label><input type="radio" name="q5" value="æœˆã«æ•°å›" onchange="onRadioChange('q5')"> æœˆã«æ•°å›</label>
          <label><input type="radio" name="q5" value="ç¨€ã ãŒç™ºç”Ÿã™ã‚‹ã¨é‡å¤§" onchange="onRadioChange('q5')"> ç¨€ã ãŒç™ºç”Ÿã™ã‚‹ã¨é‡å¤§ï¼ˆãƒã‚¤ãƒªã‚¹ã‚¯ï¼‰</label>
        </div>
        <div class="feedback-box" id="fb-q5"></div>
      </div>
      <div class="q-block">
        <label class="q-label">Q6. ã©ã®ã‚ˆã†ãªæ‚ªå½±éŸ¿ï¼ˆãƒšã‚¤ãƒ³ï¼‰ãŒç”Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ <span class="req">â˜…å¿…é ˆ</span>ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
        <div class="check-group" id="q6">
          <label><input type="checkbox" name="q6" value="åŒ»ç™‚å®‰å…¨ã®ä½ä¸‹ï¼ˆã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãƒªã‚¹ã‚¯ãªã©ï¼‰" onchange="onCheckChange('q6')"> åŒ»ç™‚å®‰å…¨ã®ä½ä¸‹ï¼ˆã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãƒªã‚¹ã‚¯ãªã©ï¼‰</label>
          <label><input type="checkbox" name="q6" value="æ¥­å‹™æ™‚é–“ã®åœ§è¿«ï¼ˆæ®‹æ¥­ãƒ»ç„¡é§„ãªè»¢è¨˜ä½œæ¥­ãªã©ï¼‰" onchange="onCheckChange('q6')"> æ¥­å‹™æ™‚é–“ã®åœ§è¿«ï¼ˆæ®‹æ¥­ãƒ»ç„¡é§„ãªè»¢è¨˜ä½œæ¥­ãªã©ï¼‰</label>
          <label><input type="checkbox" name="q6" value="æ‚£è€…ã•ã‚“ã®è‹¦ç—›ãƒ»QOLä½ä¸‹ï¼ˆç—›ã¿ã€é›¢åºŠã®é…ã‚Œãªã©ï¼‰" onchange="onCheckChange('q6')"> æ‚£è€…ã•ã‚“ã®è‹¦ç—›ãƒ»QOLä½ä¸‹ï¼ˆç—›ã¿ã€é›¢åºŠã®é…ã‚Œãªã©ï¼‰</label>
          <label><input type="checkbox" name="q6" value="ã‚¹ã‚¿ãƒƒãƒ•ã®èº«ä½“çš„ãƒ»ç²¾ç¥çš„è² æ‹…" onchange="onCheckChange('q6')"> ã‚¹ã‚¿ãƒƒãƒ•ã®èº«ä½“çš„ãƒ»ç²¾ç¥çš„è² æ‹…</label>
          <label><input type="checkbox" name="q6" value="ç‰©å“ã‚„ã‚³ã‚¹ãƒˆã®ç„¡é§„" onchange="onCheckChange('q6')"> ç‰©å“ã‚„ã‚³ã‚¹ãƒˆã®ç„¡é§„</label>
          <label><input type="checkbox" name="q6" value="ãã®ä»–" id="q6-other-check"
                        onchange="onCheckChange('q6'); toggleOtherInput('q6-other-check','q6-other-wrap')"> ãã®ä»–</label>
        </div>
        <div class="other-input-wrap" id="q6-other-wrap">
          <div class="q-hint" style="margin-bottom:6px;">ğŸ“ å…·ä½“çš„ã«ã©ã®ã‚ˆã†ãªæ‚ªå½±éŸ¿ã‹æ•™ãˆã¦ãã ã•ã„</div>
          <textarea id="q6-other-text" placeholder="ä¾‹ï¼šè¨˜éŒ²ã®è»¢è¨˜ãƒŸã‚¹ãŒèµ·ãã‚„ã™ã„ã€æƒ…å ±å…±æœ‰ã«æ™‚é–“ãŒã‹ã‹ã‚‹ ãªã©" oninput="updateProgress()"></textarea>
        </div>
        <div class="feedback-box" id="fb-q6"></div>
      </div>
      <div class="q-block">
        <label class="q-label">Q7. å›°ã£ã¦ã„ã‚‹å…·ä½“çš„ãªå ´é¢ã‚’æ•™ãˆã¦ãã ã•ã„</label>
        <div class="q-hint">ğŸ’¬ ã„ã¤ãƒ»ã©ã“ã§ãƒ»èª°ãŒãƒ»ä½•ãŒèµ·ãã‚‹ã‹ã‚’æ›¸ãã¨ä¼ã‚ã‚Šã‚„ã™ã„ã§ã™</div>
        <textarea id="q7" placeholder="ä¾‹ï¼šè¡“å¾Œã€æ‚£è€…ã•ã‚“ãŒè¤‡æ•°ãƒ«ãƒ¼ãƒˆã‚’æŒã£ãŸã¾ã¾æ­©è¡Œã™ã‚‹éš›ã€ãƒãƒ¥ãƒ¼ãƒ–ãŒå¼•ã£ã‹ã‹ã‚Šã‚„ã™ã„"
                  oninput="onTextareaInput('q7')"></textarea>
        <div class="feedback-box" id="fb-q7"></div>
      </div>
      <div class="nav-btn-row">
        <button type="button" class="btn-prev" onclick="goPrev(1)">â† æˆ»ã‚‹</button>
        <button type="button" class="btn-next" onclick="goNext(1)">æ¬¡ã¸ï¼šç¾çŠ¶ã®å¯¾å¿œ â†’</button>
      </div>
    </div>

    <!-- ã‚¹ãƒ†ãƒƒãƒ—3ï¼šç¾åœ¨ã®å¯¾å¿œ -->
    <div class="block" id="step2">
      <div class="block-title">ğŸ”„ ç¬¬3ã‚¹ãƒ†ãƒƒãƒ—ï¼šç¾åœ¨ã®å¯¾å¿œã¨ãã®é™ç•Œ <span class="badge">Cï¼šæ¯”è¼ƒå¯¾ç…§</span></div>
      <div class="q-block">
        <label class="q-label">Q8. ç¾åœ¨ã€ç¾å ´ã§ã¯ã©ã®ã‚ˆã†ã«å·¥å¤«ã—ã¦ä¹—ã‚Šåˆ‡ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ</label>
        <textarea id="q8" placeholder="ä¾‹ï¼šãƒãƒ¥ãƒ¼ãƒ–ã‚’ã¾ã¨ã‚ã¦ãƒ†ãƒ¼ãƒ—ã§ç•™ã‚ã¦ã„ã‚‹ã€ã‚¹ã‚¿ãƒƒãƒ•ãŒå¸¸ã«ä»˜ãæ·»ã† ãªã©"
                  oninput="onTextareaInput('q8')"></textarea>
        <div class="feedback-box" id="fb-q8"></div>
      </div>
      <div class="q-block">
        <label class="q-label">Q9. ä»Šã®ã‚„ã‚Šæ–¹ã®ã€Œé™ç•Œã€ã¯ä½•ã§ã™ã‹ï¼Ÿï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
        <div class="check-group" id="q9">
          <label><input type="checkbox" name="q9" value="æ‰‹ä½œæ¥­ãŒå¤šãã¦æ™‚é–“ãŒã‹ã‹ã‚‹" onchange="onCheckChange('q9')"> æ‰‹ä½œæ¥­ãŒå¤šãã¦æ™‚é–“ãŒã‹ã‹ã‚‹</label>
          <label><input type="checkbox" name="q9" value="äººã«ã‚ˆã£ã¦ã‚„ã‚Šæ–¹ã‚„ç²¾åº¦ã«ã°ã‚‰ã¤ããŒå‡ºã‚‹" onchange="onCheckChange('q9')"> äººã«ã‚ˆã£ã¦ã‚„ã‚Šæ–¹ã‚„ç²¾åº¦ã«ã°ã‚‰ã¤ããŒå‡ºã‚‹</label>
          <label><input type="checkbox" name="q9" value="æ ¹æœ¬çš„ãªè§£æ±ºï¼ˆå®‰å…¨ç¢ºä¿ãªã©ï¼‰ã«ãªã£ã¦ã„ãªã„" onchange="onCheckChange('q9')"> æ ¹æœ¬çš„ãªè§£æ±ºï¼ˆå®‰å…¨ç¢ºä¿ãªã©ï¼‰ã«ãªã£ã¦ã„ãªã„</label>
          <label><input type="checkbox" name="q9" value="æ¶ˆè€—å“è²»ãªã©ã®ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹" onchange="onCheckChange('q9')"> æ¶ˆè€—å“è²»ãªã©ã®ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹</label>
          <label><input type="checkbox" name="q9" value="ã‚¹ã‚¿ãƒƒãƒ•ã¸ã®æ•™è‚²ã‚³ã‚¹ãƒˆãŒé«˜ã„" onchange="onCheckChange('q9')"> ã‚¹ã‚¿ãƒƒãƒ•ã¸ã®æ•™è‚²ã‚³ã‚¹ãƒˆãŒé«˜ã„</label>
        </div>
        <div class="feedback-box" id="fb-q9"></div>
      </div>
      <div class="nav-btn-row">
        <button type="button" class="btn-prev" onclick="goPrev(2)">â† æˆ»ã‚‹</button>
        <button type="button" class="btn-next" onclick="goNext(2)">æ¬¡ã¸ï¼šã‚¢ã‚¤ãƒ‡ã‚¢ â†’</button>
      </div>
    </div>

    <!-- ã‚¹ãƒ†ãƒƒãƒ—4ï¼šã‚¢ã‚¤ãƒ‡ã‚¢ -->
    <div class="block" id="step3">
      <div class="block-title">ğŸ’¡ ç¬¬4ã‚¹ãƒ†ãƒƒãƒ—ï¼šã‚ãªãŸã®ã‚¢ã‚¤ãƒ‡ã‚¢ <span class="badge">Iï¼šä»‹å…¥</span></div>
      <div class="q-block">
        <label class="q-label">Q10. ã©ã®ã‚ˆã†ãªã‚¢ã‚¤ãƒ†ãƒ ãƒ»ã‚·ã‚¹ãƒ†ãƒ ãŒã‚ã‚Œã°è§£æ±ºã™ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ <span class="req">â˜…å¿…é ˆ</span></label>
        <div class="q-hint">ğŸ’­ å®Œæˆå½¢ã§ãªãã¦å¤§ä¸ˆå¤«ï¼ã€Œã“ã‚“ãªã‚‚ã®ãŒã‚ã‚Œã°â€¦ã€ã¨ã„ã†æ®µéšã®ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã‚‚æ­“è¿ã—ã¾ã™</div>
        <textarea id="q10" rows="5" placeholder="è‡ªç”±ã«æ›¸ã„ã¦ã¿ã¦ãã ã•ã„ã€‚æ€ã„ã¤ãã¾ã¾ã§OKã§ã™ã€‚"
                  oninput="onIdeaInput()" required></textarea>
        <div class="feedback-box" id="fb-q10"></div>
      </div>
      <div class="q-block">
        <label class="q-label">Q11. ã‚¢ã‚¤ãƒ‡ã‚¢ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼ˆä¸€ç•ªè¿‘ã„ã‚‚ã®ï¼‰ <span class="req">â˜…å¿…é ˆ</span></label>
        <div class="q-hint">âš¡ ä¸€ç•ªè¿‘ã„ã‚‚ã®ã‚’é¸ã‚“ã§ãã ã•ã„</div>
        <div class="radio-group" id="q11">
          <label><input type="radio" name="q11" value="åŒ»ç™‚æ©Ÿå™¨ãƒ»å™¨å…·ã®æ–°è¦é–‹ç™ºã‚„æ”¹è‰¯" onchange="onRadioChange('q11')"> ğŸ”§ åŒ»ç™‚æ©Ÿå™¨ãƒ»å™¨å…·ã®æ–°è¦é–‹ç™ºã‚„æ”¹è‰¯</label>
          <label><input type="radio" name="q11" value="ã‚¢ãƒ—ãƒªãƒ»RPAã«ã‚ˆã‚‹æ¥­å‹™è‡ªå‹•åŒ–ãƒ»é›»å­åŒ–" onchange="onRadioChange('q11')"> ğŸ’» ã‚¢ãƒ—ãƒªãƒ»RPAï¼ˆUiPathãªã©ï¼‰ã«ã‚ˆã‚‹æ¥­å‹™è‡ªå‹•åŒ–ãƒ»é›»å­åŒ–</label>
          <label><input type="radio" name="q11" value="æ—¢å­˜è£½å“ã®æ–°ã—ã„ä½¿ã„æ–¹ï¼ˆè»¢ç”¨ãƒ»é©å¿œå¤–ä½¿ç”¨ãªã©ï¼‰" onchange="onRadioChange('q11')"> â™»ï¸ æ—¢å­˜è£½å“ã®æ–°ã—ã„ä½¿ã„æ–¹ï¼ˆè»¢ç”¨ãƒ»é©å¿œå¤–ä½¿ç”¨ãªã©ï¼‰</label>
          <label><input type="radio" name="q11" value="é‹ç”¨ãƒ«ãƒ¼ãƒ«ã‚„ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã®å¤‰æ›´" onchange="onRadioChange('q11')"> ğŸ“„ é‹ç”¨ãƒ«ãƒ¼ãƒ«ã‚„ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã®å¤‰æ›´</label>
        </div>
        <div class="feedback-box" id="fb-q11"></div>
      </div>
      <div class="nav-btn-row">
        <button type="button" class="btn-prev" onclick="goPrev(3)">â† æˆ»ã‚‹</button>
        <button type="button" class="btn-next" onclick="goNext(3)">æ¬¡ã¸ï¼šæœŸå¾…åŠ¹æœ â†’</button>
      </div>
    </div>

    <!-- ã‚¹ãƒ†ãƒƒãƒ—5ï¼šæœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ -->
    <div class="block" id="step4">
      <div class="block-title">ğŸ“Š ç¬¬5ã‚¹ãƒ†ãƒƒãƒ—ï¼šæœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ <span class="badge">Oï¼šã‚¢ã‚¦ãƒˆã‚«ãƒ </span></div>
      <div class="q-block">
        <label class="q-label">Q12. ã“ã®ã‚¢ã‚¤ãƒ‡ã‚¢ãŒå®Ÿç¾ã™ã‚‹ã¨ã€ä½•ãŒæ”¹å–„ã—ã¾ã™ã‹ï¼Ÿ <span class="req">â˜…å¿…é ˆ</span>ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
        <div class="check-group" id="q12">
          <label><input type="checkbox" name="q12" value="ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆä»¶æ•°ã®æ¸›å°‘ï¼ˆåŒ»ç™‚å®‰å…¨ã®å‘ä¸Šï¼‰" onchange="onCheckChange('q12')"> ğŸ›¡ï¸ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆä»¶æ•°ã®æ¸›å°‘ï¼ˆåŒ»ç™‚å®‰å…¨ã®å‘ä¸Šï¼‰</label>
          <label><input type="checkbox" name="q12" value="æ¥­å‹™æ™‚é–“ãƒ»è¨˜éŒ²æ™‚é–“ã®çŸ­ç¸®" onchange="onCheckChange('q12')"> â±ï¸ æ¥­å‹™æ™‚é–“ãƒ»è¨˜éŒ²æ™‚é–“ã®çŸ­ç¸®</label>
          <label><input type="checkbox" name="q12" value="æ‚£è€…ã•ã‚“ã®å›å¾©ä¿ƒé€²ï¼ˆæ—©æœŸé›¢åºŠãƒ»QOLå‘ä¸Šãªã©ï¼‰" onchange="onCheckChange('q12')"> ğŸƒ æ‚£è€…ã•ã‚“ã®å›å¾©ä¿ƒé€²ï¼ˆæ—©æœŸé›¢åºŠãƒ»QOLå‘ä¸Šãªã©ï¼‰</label>
          <label><input type="checkbox" name="q12" value="ã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼ˆç‰©å“è²»ãƒ»äººä»¶è²»ãªã©ï¼‰" onchange="onCheckChange('q12')"> ğŸ’´ ã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼ˆç‰©å“è²»ãƒ»äººä»¶è²»ãªã©ï¼‰</label>
          <label><input type="checkbox" name="q12" value="ã‚¹ã‚¿ãƒƒãƒ•ã®è² æ‹…è»½æ¸›ãƒ»æº€è¶³åº¦å‘ä¸Š" onchange="onCheckChange('q12')"> ğŸ˜Š ã‚¹ã‚¿ãƒƒãƒ•ã®è² æ‹…è»½æ¸›ãƒ»æº€è¶³åº¦å‘ä¸Š</label>
          <label><input type="checkbox" name="q12" value="ãã®ä»–" id="q12-other-check"
                        onchange="onCheckChange('q12'); toggleOtherInput('q12-other-check','q12-other-wrap')"> ãã®ä»–</label>
        </div>
        <div class="other-input-wrap" id="q12-other-wrap">
          <div class="q-hint" style="margin-bottom:6px;">ğŸ“ ã©ã®ã‚ˆã†ãªæ”¹å–„ãŒæœŸå¾…ã§ãã‚‹ã‹æ•™ãˆã¦ãã ã•ã„</div>
          <textarea id="q12-other-text" placeholder="ä¾‹ï¼šæ‚£è€…æº€è¶³åº¦ã®å‘ä¸Šã€ã‚¹ã‚¿ãƒƒãƒ•é–“ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ”¹å–„ ãªã©" oninput="updateProgress()"></textarea>
        </div>
        <div class="feedback-box" id="fb-q12"></div>
      </div>
      <div class="q-block">
        <label class="q-label">Q13. ã©ã®ãã‚‰ã„è‰¯ããªã‚Šãã†ã§ã™ã‹ï¼Ÿï¼ˆã‚ã‹ã‚‹ç¯„å›²ã§ï¼‰</label>
        <div class="q-hint">ğŸ’¬ è¨˜å…¥ä¾‹ï¼š1æ—¥ã‚ãŸã‚Š1æ™‚é–“ã®æ¥­å‹™å‰Šæ¸› / ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãŒåŠæ¸› / è¡“å¾Œé›¢åºŠãŒ1æ—¥æ—©ã¾ã‚‹ ãªã©</div>
        <textarea id="q13" placeholder="æ•°å€¤ã‚„å‰²åˆã§æ›¸ã‘ã‚‹ã¨ã€ã‚ˆã‚Šé–‹ç™ºãŒã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚"
                  oninput="onTextareaInput('q13')"></textarea>
        <div class="feedback-box" id="fb-q13"></div>
      </div>
      <div class="q-block">
        <label class="q-label">Q14. å‚è€ƒã«ãªã‚‹å†™çœŸãƒ»è³‡æ–™ãŒã‚ã‚Œã°ãƒ¡ãƒ¼ãƒ«ã«æ·»ä»˜ã—ã¦ãã ã•ã„ï¼ˆä»»æ„ï¼‰</label>
        <div class="q-hint">ğŸ“ ç¾åœ¨ã®å•é¡Œã®æ§˜å­ã€å‚è€ƒã«ã—ãŸã„è£½å“ç”»åƒã€æ‰‹æ›¸ãã‚¹ã‚±ãƒƒãƒãªã©ï¼ˆJPGãƒ»PNGãƒ»PDFå¯¾å¿œï¼‰ã‚’ãƒ¡ãƒ¼ãƒ«é€ä¿¡æ™‚ã«ç›´æ¥æ·»ä»˜ã—ã¦ãã ã•ã„ã€‚</div>
      </div>
      <div class="nav-btn-row">
        <button type="button" class="btn-prev" onclick="goPrev(4)">â† æˆ»ã‚‹</button>
        <button type="button" class="btn-preview" onclick="showPreview()">ğŸ‘ï¸ å†…å®¹ã‚’ç¢ºèªã—ã¦é€ä¿¡</button>
      </div>
      <div style="text-align:center; margin-top:12px;">
        <button type="button" class="btn-reset" onclick="resetForm()">ğŸ”„ æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
      </div>
    </div>

  </form>
</div>

<!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼†é€ä¿¡ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-overlay" id="previewModal">
  <div class="modal">
    <h2>ğŸ“‹ å…¥åŠ›å†…å®¹ã®ç¢ºèª</h2>
    <p style="font-size:0.85em;color:#666;margin-bottom:12px;">ä»¥ä¸‹ã®å†…å®¹ã§æå‡ºã—ã¾ã™ã€‚é€ä¿¡æ–¹æ³•ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
    <pre id="previewText"></pre>
    <div id="picoBox" style="margin-top:14px; padding:14px; background:#eaf4fb; border-radius:8px;
         font-size:0.83em; line-height:1.9; border-left:4px solid #2e86c1; display:none;">
      <strong>ğŸ”¬ è‡ªå‹•ç”Ÿæˆï¼šç ”ç©¶è¨ˆç”»éª¨æ ¼ï¼ˆPICOï¼‰</strong><br>
      <span id="picoContent"></span>
    </div>
    <div class="modal-btn-row">
      <button class="btn-mail"  onclick="sendMail()">âœ‰ï¸ ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡</button>
      <button class="btn-dl"    onclick="downloadTxt()">ğŸ’¾ TXTã§ä¿å­˜</button>
      <!-- â–¼ é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ï¼šæ„Ÿè¬ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ -->
      <button class="btn-close" onclick="closePreviewAndThank()">âœ– é–‰ã˜ã‚‹</button>
    </div>
  </div>
</div>

<!-- â–¼â–¼â–¼ æ„Ÿè¬ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆæ–°è¦è¿½åŠ ï¼‰ â–¼â–¼â–¼ -->
<div class="thank-modal-overlay" id="thankModal">
  <div class="thank-modal">
    <div class="thank-icon">ğŸ‰</div>
    <div class="thank-title">ã”å”åŠ›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</div>
    <div class="thank-body">
      <strong id="thank-name-label"></strong><br>
      ã‚ãªãŸã®ç¾å ´ã‹ã‚‰ã®å£°ãŒã€<br>
      <strong>åŒ»ç™‚ã‚’ã‚ˆã‚Šã‚ˆãã™ã‚‹ãŸã‚ã®ç¬¬ä¸€æ­©</strong>ã«ãªã‚Šã¾ã™ã€‚<br><br>
      ææ¡ˆå†…å®¹ã¯æ‹…å½“éƒ¨ç½²ã«ã¦ç¢ºèªãƒ»æ¤œè¨ã„ãŸã—ã¾ã™ã€‚<br>
      å¼•ãç¶šãã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ãŠå¯„ã›ãã ã•ã„ğŸ˜Š
    </div>
    <div class="thank-btn-row">
      <button class="btn-new-idea" onclick="startNewIdea()">ğŸ’¡ æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ææ¡ˆã™ã‚‹</button>
      <button class="btn-just-close" onclick="closeThankModal()">ã“ã®ã¾ã¾é–‰ã˜ã‚‹</button>
    </div>
  </div>
</div>
<!-- â–²â–²â–² æ„Ÿè¬ãƒ¢ãƒ¼ãƒ€ãƒ«ã“ã“ã¾ã§ â–²â–²â–² -->

<script>
// ============================================================
//  è¨­å®š
// ============================================================
const MAIL_TO = 'ns.morizo@gmail.com';

// ============================================================
//  ã‚¹ãƒ†ãƒƒãƒ—ç®¡ç†
// ============================================================
let currentStep = 0;
const TOTAL_STEPS = 5;

const NAV_MESSAGES = [
  'ã“ã‚“ã«ã¡ã¯ï¼ç¾å ´ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„ãŠå›°ã‚Šã”ã¨ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚<br>ã¾ãšã€<strong>ã‚ãªãŸã®åŸºæœ¬æƒ…å ±</strong>ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚æ°—è»½ã«å…¥åŠ›ã—ã¦ãã ã•ã„ğŸ˜Š',
  'åŸºæœ¬æƒ…å ±ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼âœ¨<br>æ¬¡ã¯<strong>ç¾å ´ã§ã®èª²é¡Œ</strong>ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚ã€Œèª°ãŒã€ã€Œã©ã‚“ãªé »åº¦ã§ã€å›°ã£ã¦ã„ã‚‹ã‹ã‚’æ•™ãˆã¦ã‚‚ã‚‰ãˆã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™ã€‚',
  'èª²é¡ŒãŒã‚ˆãä¼ã‚ã£ã¦ãã¾ã™ï¼ğŸ‘<br>æ¬¡ã¯<strong>ä»Šã©ã®ã‚ˆã†ã«å¯¾å¿œã—ã¦ã„ã‚‹ã‹</strong>ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚ç¾çŠ¶ã®å·¥å¤«ã¨ã€ãã®é™ç•Œã‚’ç‡ç›´ã«æ•™ãˆã¦ãã ã•ã„ã€‚',
  'ã“ã“ã‹ã‚‰ãŒä¸€ç•ªå¤§åˆ‡ãªãƒ‘ãƒ¼ãƒˆã§ã™ï¼ğŸ’¡<br><strong>ã‚ãªãŸã®ã‚¢ã‚¤ãƒ‡ã‚¢</strong>ã‚’èã‹ã›ã¦ãã ã•ã„ã€‚å®Œæˆå½¢ã§ãªãã¦å¤§ä¸ˆå¤«ã€‚ã€Œã“ã‚“ãªã‚‚ã®ãŒã‚ã‚Œã°â€¦ã€ã¨ã„ã†ãƒ¬ãƒ™ãƒ«ã§ã‚‚å¤§æ­“è¿ã§ã™ï¼',
  'ã‚¢ã‚¤ãƒ‡ã‚¢ã€ç´ æ™´ã‚‰ã—ã„ã§ã™ï¼ğŸ‰<br>æœ€å¾Œã«<strong>æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ</strong>ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚æ•°å€¤ã§è¡¨ç¾ã§ãã‚‹ã¨ã€å®Ÿç¾ã«å‘ã‘ãŸè¨ˆç”»ãŒç«‹ã¦ã‚„ã™ããªã‚Šã¾ã™ã€‚'
];

function showStep(step) {
  document.querySelectorAll('.block').forEach((b, i) => {
    b.classList.toggle('active', i === step);
  });
  for (let i = 0; i < TOTAL_STEPS; i++) {
    const sc = document.getElementById(`sc${i}`);
    const sl = document.getElementById(`sl${i}`);
    sc.className = 'step-circle';
    sl.className = 'step-label';
    if (i < step)        { sc.classList.add('done'); sc.innerHTML = '<span class="check-anim">âœ“</span>'; }
    else if (i === step) { sc.classList.add('active'); sc.textContent = i + 1; sl.classList.add('active'); }
    else                 { sc.textContent = i + 1; }
    if (i < TOTAL_STEPS - 1) {
      document.getElementById(`line${i}`).className = 'step-line' + (i < step ? ' done' : '');
    }
  }
  document.getElementById('navBubble').innerHTML = NAV_MESSAGES[step];
  window.scrollTo({ top: 0, behavior: 'smooth' });
  currentStep = step;
}

// ============================================================
//  ã‚¹ãƒ†ãƒƒãƒ—æ¤œè¨¼
// ============================================================
const STEP_REQUIRED = [
  () => {
    const errs = [];
    if (!getVal('q1'))   errs.push('Q1 æ‰€å±éƒ¨ç½²');
    if (!getVal('q2'))   errs.push('Q2 æ°å');
    if (!getRadio('q3')) errs.push('Q3 è·ç¨®');
    return errs;
  },
  () => {
    const errs = [];
    if (!getRadio('q4'))              errs.push('Q4 å›°ã£ã¦ã„ã‚‹å¯¾è±¡');
    if (!getRadio('q5'))              errs.push('Q5 ç™ºç”Ÿé »åº¦');
    if (getChecks('q6').length === 0) errs.push('Q6 æ‚ªå½±éŸ¿ï¼ˆãƒšã‚¤ãƒ³ï¼‰');
    return errs;
  },
  () => [],
  () => {
    const errs = [];
    if (!getVal('q10'))   errs.push('Q10 ã‚¢ã‚¤ãƒ‡ã‚¢');
    if (!getRadio('q11')) errs.push('Q11 ã‚«ãƒ†ã‚´ãƒªãƒ¼');
    return errs;
  },
  () => {
    const errs = [];
    if (getChecks('q12').length === 0) errs.push('Q12 æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ');
    return errs;
  }
];

function goNext(step) {
  const errs = STEP_REQUIRED[step]();
  if (errs.length > 0) {
    alert('âš ï¸ ä»¥ä¸‹ã®å¿…é ˆé …ç›®ãŒæœªå…¥åŠ›ã§ã™ï¼š\n\n' + errs.join('\n'));
    return;
  }
  showStep(step + 1);
}
function goPrev(step) { showStep(step - 1); }

// ============================================================
//  ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
// ============================================================
function getVal(id)    { return (document.getElementById(id)||{value:''}).value.trim(); }
function getRadio(nm)  { const el = document.querySelector(`input[name="${nm}"]:checked`); return el ? el.value : ''; }
function getChecks(nm) { return [...document.querySelectorAll(`input[name="${nm}"]:checked`)].map(e=>e.value); }

function getQ6Values() {
  return getChecks('q6').map(v => {
    if (v === 'ãã®ä»–') {
      const other = getVal('q6-other-text');
      return other ? `ãã®ä»–ï¼ˆ${other}ï¼‰` : 'ãã®ä»–';
    }
    return v;
  });
}
function getQ12Values() {
  return getChecks('q12').map(v => {
    if (v === 'ãã®ä»–') {
      const other = getVal('q12-other-text');
      return other ? `ãã®ä»–ï¼ˆ${other}ï¼‰` : 'ãã®ä»–';
    }
    return v;
  });
}

function showFeedback(id, msg, type) {
  const el = document.getElementById(`fb-${id}`);
  if (!el) return;
  el.textContent = msg;
  el.className = `feedback-box feedback-${type} show`;
}
function hideFeedback(id) {
  const el = document.getElementById(`fb-${id}`);
  if (el) { el.className = 'feedback-box'; el.textContent = ''; }
}
function highlightSelected(groupId) {
  document.querySelectorAll(`#${groupId} label`).forEach(lbl => {
    lbl.classList.toggle('selected', lbl.querySelector('input').checked);
  });
}
function highlightChecked(groupId) {
  document.querySelectorAll(`#${groupId} label`).forEach(lbl => {
    lbl.classList.toggle('selected', lbl.querySelector('input').checked);
  });
}
function toggleOtherInput(checkId, wrapId) {
  const checked = document.getElementById(checkId).checked;
  const wrap = document.getElementById(wrapId);
  wrap.classList.toggle('show', checked);
  if (!checked) {
    const ta = wrap.querySelector('textarea');
    if (ta) ta.value = '';
  }
}

// ============================================================
//  ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼
// ============================================================
function updateProgress() {
  const items = [
    getVal('q1'), getVal('q2'), getRadio('q3'), getRadio('q4'),
    getRadio('q5'), getChecks('q6').length > 0 ? '1' : '',
    getVal('q7'), getVal('q8'), getChecks('q9').length > 0 ? '1' : '',
    getVal('q10'), getRadio('q11'), getChecks('q12').length > 0 ? '1' : '', getVal('q13')
  ];
  const filled = items.filter(v => v !== '').length;
  document.getElementById('progress-label').textContent = `${filled} / 13 é …ç›®å…¥åŠ›æ¸ˆã¿`;
  document.getElementById('progressFill').style.width = `${Math.round(filled / 13 * 100)}%`;
}
document.addEventListener('change', updateProgress);
document.addEventListener('input',  updateProgress);

// ============================================================
//  ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯é–¢æ•°ç¾¤
// ============================================================
function onSelectChange(id) {
  const v = getVal(id);
  if (v) showFeedback(id, `âœ… ã€Œ${v}ã€ã§ç™»éŒ²ã—ã¾ã™ï¼`, 'good');
  else   hideFeedback(id);
}
function onTextInput(id) {
  const v = getVal(id);
  if (!v) { hideFeedback(id); return; }
  if (v === 'åŒ¿å') showFeedback(id, 'ğŸ™ˆ åŒ¿åã§å—ã‘ä»˜ã‘ã¾ã™ã€‚å®‰å¿ƒã—ã¦ã©ã†ãã€‚', 'tip');
  else if (v.length >= 2) showFeedback(id, `âœ… ${v} ã•ã‚“ã€ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ï¼`, 'good');
}
function onRadioChange(name) {
  highlightSelected(name);
  const v = getRadio(name);
  const feedbackMap = {
    q3: { 'åŒ»å¸«':'ğŸ©º åŒ»å¸«ã®è¦–ç‚¹ã§ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã€å¤§å¤‰å‚è€ƒã«ãªã‚Šã¾ã™ï¼', 'çœ‹è­·å¸«':'ğŸ’‰ çœ‹è­·å¸«ã•ã‚“ã®ç¾å ´æ„Ÿè¦šã¯ã‚¢ã‚¤ãƒ‡ã‚¢ã®å®åº«ã§ã™ï¼', 'è–¬å‰¤å¸«':'ğŸ’Š è–¬å‰¤å¸«ã•ã‚“ã®å°‚é–€çŸ¥è­˜ãŒè§£æ±ºã®ã‚«ã‚®ã«ãªã‚‹ã“ã¨ã‚‚ã€‚', 'è‡¨åºŠå·¥å­¦æŠ€å£«':'âš™ï¸ æ©Ÿå™¨ãƒ»ã‚·ã‚¹ãƒ†ãƒ ç³»ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚‚å¤§æ­“è¿ã§ã™ï¼', 'ç†å­¦ç™‚æ³•å£«ãƒ»ä½œæ¥­ç™‚æ³•å£«':'ğŸƒ ãƒªãƒãƒ“ãƒªç¾å ´ã®çŸ¥è¦‹ã€ãœã²èã‹ã›ã¦ãã ã•ã„ï¼', 'äº‹å‹™è·':'ğŸ“‹ äº‹å‹™ãƒ»ç®¡ç†ç³»ã®æ”¹å–„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚‚é‡è¦ã§ã™ï¼', 'ãã®ä»–':'ğŸ‘¤ ã©ã‚“ãªç«‹å ´ã‹ã‚‰ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚‚å¤§åˆ‡ã«ã—ã¾ã™ï¼' },
    q4: { 'æ‚£è€…ã•ã‚“':'ğŸ¥ æ‚£è€…ä¸­å¿ƒã®ã‚¢ã‚¤ãƒ‡ã‚¢ã¯æœ€ã‚‚ä¾¡å€¤ãŒã‚ã‚Šã¾ã™ï¼', 'è‡ªåˆ†è‡ªèº«ãƒ»è‡ªéƒ¨ç½²ã®ã‚¹ã‚¿ãƒƒãƒ•':'ğŸ‘¥ ç¾å ´ã‚¹ã‚¿ãƒƒãƒ•ã®å£°ãŒæ”¹å–„ã®ç¬¬ä¸€æ­©ã§ã™ï¼', 'ä»–éƒ¨ç½²ã®ã‚¹ã‚¿ãƒƒãƒ•':'ğŸ¤ éƒ¨ç½²é–“ã®é€£æºæ”¹å–„ã«ã¤ãªãŒã‚Šãã†ã§ã™ã­ã€‚', 'ç—…é™¢å…¨ä½“':'ğŸ¢ ç—…é™¢å…¨ä½“ã®ã‚·ã‚¹ãƒ†ãƒ æ”¹å–„ã¯å¤§ããªå½±éŸ¿åŠ›ãŒã‚ã‚Šã¾ã™ï¼' },
    q5: { 'æ¯æ—¥è¤‡æ•°å›':'ğŸ”´ æ¯æ—¥è¤‡æ•°å›ã¨ã¯ã€ã‹ãªã‚Šç·Šæ€¥åº¦ãŒé«˜ã„ã§ã™ã­ã€‚æ—©æ€¥ãªè§£æ±ºãŒå¿…è¦ãã†ã§ã™ã€‚', 'æ¯æ—¥1å›ç¨‹åº¦':'ğŸŸ  æ¯æ—¥ç™ºç”Ÿã—ã¦ã„ã‚‹ãªã‚‰ã€ç¢ºå®Ÿã«è§£æ±ºç­–ãŒå¿…è¦ã§ã™ã€‚', 'é€±ã«æ•°å›':'ğŸŸ¡ é€±ã«æ•°å›ã®ç™ºç”Ÿã§ã‚‚ã€ç©ã¿é‡ãªã‚‹ã¨å¤§ããªè² æ‹…ã«ãªã‚Šã¾ã™ã­ã€‚', 'æœˆã«æ•°å›':'ğŸŸ¢ é »åº¦ã¯ä½ãã¦ã‚‚ã€å¯¾ç­–ã—ã¦ãŠãä¾¡å€¤ã¯ååˆ†ã‚ã‚Šã¾ã™ã€‚', 'ç¨€ã ãŒç™ºç”Ÿã™ã‚‹ã¨é‡å¤§':'âš ï¸ ãƒã‚¤ãƒªã‚¹ã‚¯ãªäº‹è±¡ã¯é »åº¦ãŒä½ãã¦ã‚‚æœ€å„ªå…ˆã§å¯¾ç­–ãŒå¿…è¦ã§ã™ï¼' },
    q11: { 'åŒ»ç™‚æ©Ÿå™¨ãƒ»å™¨å…·ã®æ–°è¦é–‹ç™ºã‚„æ”¹è‰¯':'ğŸ”§ æ©Ÿå™¨ãƒ»å™¨å…·ç³»ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã­ï¼å°‚é–€æ‹…å½“è€…ã¨é€£æºã—ã¦æ¤œè¨ã—ã¾ã™ã€‚', 'ã‚¢ãƒ—ãƒªãƒ»RPAã«ã‚ˆã‚‹æ¥­å‹™è‡ªå‹•åŒ–ãƒ»é›»å­åŒ–':'ğŸ’» ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ãƒ»è‡ªå‹•åŒ–ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã­ï¼æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ æ‹…å½“ã¨é€£æºã—ã¾ã™ã€‚', 'æ—¢å­˜è£½å“ã®æ–°ã—ã„ä½¿ã„æ–¹ï¼ˆè»¢ç”¨ãƒ»é©å¿œå¤–ä½¿ç”¨ãªã©ï¼‰':'â™»ï¸ æ—¢å­˜å“ã®è»¢ç”¨ã¨ã¯é¢ç™½ã„ç™ºæƒ³ã§ã™ã­ï¼è–¬äº‹ç¢ºèªã‚‚å«ã‚ã¦æ¤œè¨ã—ã¾ã™ã€‚', 'é‹ç”¨ãƒ«ãƒ¼ãƒ«ã‚„ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã®å¤‰æ›´':'ğŸ“„ é‹ç”¨æ”¹å–„ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã­ã€‚æ¯”è¼ƒçš„ã™ãã«å®Ÿè¡Œã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼' }
  };
  const msg = (feedbackMap[name] || {})[v];
  if (msg) showFeedback(name, msg, 'good');
}
function onCheckChange(name) {
  highlightChecked(name);
  const checks = getChecks(name);
  if (name === 'q6') {
    if (checks.length === 0) { hideFeedback('q6'); return; }
    const hasOther = checks.includes('ãã®ä»–');
    if (checks.length === 1 && hasOther)    showFeedback('q6', 'ğŸ“ ä¸‹ã®æ¬„ã«å…·ä½“çš„ãªå†…å®¹ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„ã€‚', 'tip');
    else if (checks.length === 1)           showFeedback('q6', `âœ… ã€Œ${checks[0]}ã€ã‚’é¸æŠã—ã¾ã—ãŸã€‚ä»–ã«ã‚‚è©²å½“ã™ã‚‹ã‚‚ã®ãŒã‚ã‚Œã°è¿½åŠ ã—ã¦ãã ã•ã„ã€‚`, 'good');
    else if (checks.length >= 3)            showFeedback('q6', `âš¡ ${checks.length}ã¤ã®å•é¡ŒãŒé‡ãªã£ã¦ã„ã‚‹ã‚“ã§ã™ã­ã€‚è¤‡åˆçš„ãªèª²é¡Œã§ã™ã€‚ã‚¢ã‚¤ãƒ‡ã‚¢ã§ä¸€æ°—ã«è§£æ±ºã—ã¾ã—ã‚‡ã†ï¼`, 'tip');
    else                                    showFeedback('q6', `âœ… ${checks.length}ã¤é¸æŠæ¸ˆã¿ã€‚ä»–ã«ã‚‚ã‚ã‚Œã°è¿½åŠ ã—ã¦ãã ã•ã„ã€‚`, 'good');
  }
  if (name === 'q9') {
    if (checks.length === 0) { hideFeedback('q9'); return; }
    showFeedback('q9', `âœ… ${checks.length}ã¤ã®é™ç•Œã‚’é¸æŠã€‚ã“ã‚Œã ã‘ã®å•é¡ŒãŒã‚ã‚‹ãªã‚‰ã€æ”¹å–„ã®ä½™åœ°ã¯å¤§ãã„ã§ã™ã­ï¼`, 'good');
  }
  if (name === 'q12') {
    if (checks.length === 0) { hideFeedback('q12'); return; }
    const hasOther = checks.includes('ãã®ä»–');
    if (checks.length === 1 && hasOther)    showFeedback('q12', 'ğŸ“ ä¸‹ã®æ¬„ã«æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœã‚’è¨˜å…¥ã—ã¦ãã ã•ã„ã€‚', 'tip');
    else if (checks.length === 1)           showFeedback('q12', `âœ… ã€Œ${checks[0]}ã€ã‚’é¸æŠã€‚ã“ã®åŠ¹æœã‚’è»¸ã«ææ¡ˆã‚’é€²ã‚ã¾ã™ï¼`, 'good');
    else if (checks.length >= 3)            showFeedback('q12', `ğŸš€ ${checks.length}ã¤ã®æ”¹å–„åŠ¹æœãŒæœŸå¾…ã§ãã‚‹ã€ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®å¤§ãã„ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã­ï¼`, 'good');
    else                                    showFeedback('q12', `âœ… ${checks.length}ã¤ã®æ”¹å–„åŠ¹æœã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ï¼`, 'good');
  }
}
function onTextareaInput(id) {
  const v = getVal(id); if (!v) { hideFeedback(id); return; }
  const len = v.length;
  if (id === 'q7') {
    if (len < 20)      showFeedback('q7', 'âœï¸ ã‚‚ã†å°‘ã—è©³ã—ãæ•™ãˆã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿã€Œã„ã¤ãƒ»ã©ã“ã§ãƒ»èª°ãŒãƒ»ä½•ãŒèµ·ãã‚‹ã€ã‚’æ„è­˜ã™ã‚‹ã¨ä¼ã‚ã‚Šã‚„ã™ã„ã§ã™ã€‚', 'neutral');
    else if (len < 50) showFeedback('q7', 'ğŸ“ ã„ã„æ„Ÿã˜ã§ã™ï¼ã‚‚ã†å°‘ã—å…·ä½“çš„ãªçŠ¶æ³ã‚’åŠ ãˆã‚‹ã¨å®Œç’§ã§ã™ã€‚', 'tip');
    else               showFeedback('q7', 'âœ… å…·ä½“çš„ã§åˆ†ã‹ã‚Šã‚„ã™ã„å ´é¢æå†™ã§ã™ï¼', 'good');
  }
  if (id === 'q8') {
    if (len < 15) showFeedback('q8', 'âœï¸ ç¾åœ¨ã®å¯¾å¿œã‚’å°‘ã—è©³ã—ãæ•™ãˆã¦ãã ã•ã„ã€‚', 'neutral');
    else          showFeedback('q8', 'âœ… ç¾çŠ¶ã®å·¥å¤«ãŒä¼ã‚ã‚Šã¾ã™ã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼', 'good');
  }
  if (id === 'q13') {
    const hasNum = /[0-9ï¼-ï¼™]/.test(v);
    if (hasNum) showFeedback('q13', 'ğŸ¯ æ•°å€¤ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼å…·ä½“çš„ãªç›®æ¨™å€¤ãŒã‚ã‚‹ã¨ææ¡ˆã®èª¬å¾—åŠ›ãŒå¢—ã—ã¾ã™ã€‚', 'good');
    else        showFeedback('q13', 'ğŸ’¡ ã€Œã€‡ã€‡åˆ†å‰Šæ¸›ã€ã€Œã€‡ã€‡%æ”¹å–„ã€ãªã©æ•°å€¤ã§è¡¨ç¾ã§ãã‚‹ã¨ã€ã‚ˆã‚Šå®Ÿç¾ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæ¹§ãã¾ã™ã€‚', 'tip');
  }
}
function onIdeaInput() {
  const v = getVal('q10'); if (!v) { hideFeedback('q10'); return; }
  const len = v.length;
  if (len < 20)       showFeedback('q10', 'ğŸ’­ ã‚¢ã‚¤ãƒ‡ã‚¢ã®ç¨®ãŒç”Ÿã¾ã‚Œã¦ã„ã¾ã™ã­ï¼ã‚‚ã†å°‘ã—è†¨ã‚‰ã¾ã›ã¦ã¿ã¦ãã ã•ã„ã€‚', 'neutral');
  else if (len < 60)  showFeedback('q10', 'ğŸ’¡ ã„ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒå‡ºã¦ãã¾ã—ãŸï¼ã€Œèª°ãŒãƒ»ä½•ã‚’ãƒ»ã©ã†ã‚„ã£ã¦ä½¿ã†ã‹ã€ã‚’åŠ ãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚', 'tip');
  else if (len < 120) showFeedback('q10', 'âœ¨ å…·ä½“æ€§ãŒå¢—ã—ã¦ãã¾ã—ãŸï¼ç´ æ™´ã‚‰ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã€‚', 'good');
  else                showFeedback('q10', 'ğŸš€ ã¨ã¦ã‚‚è©³ç´°ãªã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ï¼å®Ÿç¾ã«å‘ã‘ã¦å‹•ãå‡ºã›ãã†ã§ã™ã­ã€‚', 'good');
}

// ============================================================
//  ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
// ============================================================
function validate() {
  const required = [
    { val: getVal('q1'),                            label: 'Q1 æ‰€å±éƒ¨ç½²' },
    { val: getVal('q2'),                            label: 'Q2 æ°å' },
    { val: getRadio('q3'),                          label: 'Q3 è·ç¨®' },
    { val: getRadio('q4'),                          label: 'Q4 å›°ã£ã¦ã„ã‚‹å¯¾è±¡' },
    { val: getRadio('q5'),                          label: 'Q5 ç™ºç”Ÿé »åº¦' },
    { val: getChecks('q6').length > 0 ? '1' : '',  label: 'Q6 æ‚ªå½±éŸ¿ï¼ˆãƒšã‚¤ãƒ³ï¼‰' },
    { val: getVal('q10'),                           label: 'Q10 ã‚¢ã‚¤ãƒ‡ã‚¢' },
    { val: getRadio('q11'),                         label: 'Q11 ã‚«ãƒ†ã‚´ãƒªãƒ¼' },
    { val: getChecks('q12').length > 0 ? '1' : '', label: 'Q12 æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ' },
  ];
  const missing = required.filter(r => !r.val).map(r => r.label);
  if (missing.length > 0) {
    alert('âš ï¸ ä»¥ä¸‹ã®å¿…é ˆé …ç›®ãŒæœªå…¥åŠ›ã§ã™ï¼š\n\n' + missing.join('\n'));
    return false;
  }
  return true;
}

// ============================================================
//  ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
// ============================================================
function buildText() {
  const now = new Date().toLocaleString('ja-JP');
  const q6  = getQ6Values().join(' / ')  || 'ï¼ˆæœªé¸æŠï¼‰';
  const q9  = getChecks('q9').join(' / ')|| 'ï¼ˆæœªé¸æŠï¼‰';
  const q12 = getQ12Values().join(' / ') || 'ï¼ˆæœªé¸æŠï¼‰';
  return `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’¡ é™¢å†…ã‚¢ã‚¤ãƒ‡ã‚¢ï¼†ãŠå›°ã‚Šã”ã¨ææ¡ˆãƒ•ã‚©ãƒ¼ãƒ 
é€ä¿¡æ—¥æ™‚ï¼š${now}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€ç¬¬1ãƒ–ãƒ­ãƒƒã‚¯ï¼šåŸºæœ¬æƒ…å ±ã€‘
Q1. æ‰€å±éƒ¨ç½²    ï¼š ${getVal('q1') || 'ï¼ˆæœªå…¥åŠ›ï¼‰'}
Q2. æ°å       ï¼š ${getVal('q2') || 'ï¼ˆæœªå…¥åŠ›ï¼‰'}
Q3. è·ç¨®       ï¼š ${getRadio('q3') || 'ï¼ˆæœªé¸æŠï¼‰'}

ã€ç¬¬2ãƒ–ãƒ­ãƒƒã‚¯ï¼šç¾å ´ã®èª²é¡Œ â€” Pï¼šå¯¾è±¡ãƒ»èƒŒæ™¯ã€‘
Q4. å›°ã£ã¦ã„ã‚‹å¯¾è±¡  ï¼š ${getRadio('q4') || 'ï¼ˆæœªé¸æŠï¼‰'}
Q5. ç™ºç”Ÿé »åº¦       ï¼š ${getRadio('q5') || 'ï¼ˆæœªé¸æŠï¼‰'}
Q6. æ‚ªå½±éŸ¿ï¼ˆãƒšã‚¤ãƒ³ï¼‰ ï¼š ${q6}
Q7. å…·ä½“çš„ãªå ´é¢    ï¼š
${getVal('q7') || 'ï¼ˆæœªè¨˜å…¥ï¼‰'}

ã€ç¬¬3ãƒ–ãƒ­ãƒƒã‚¯ï¼šç¾åœ¨ã®å¯¾å¿œ â€” Cï¼šæ¯”è¼ƒå¯¾ç…§ã€‘
Q8. ç¾åœ¨ã®å·¥å¤«  ï¼š
${getVal('q8') || 'ï¼ˆæœªè¨˜å…¥ï¼‰'}
Q9. ç¾çŠ¶ã®é™ç•Œ  ï¼š ${q9}

ã€ç¬¬4ãƒ–ãƒ­ãƒƒã‚¯ï¼šã‚¢ã‚¤ãƒ‡ã‚¢ â€” Iï¼šä»‹å…¥ã€‘
Q10. ã‚¢ã‚¤ãƒ‡ã‚¢   ï¼š
${getVal('q10') || 'ï¼ˆæœªè¨˜å…¥ï¼‰'}
Q11. ã‚«ãƒ†ã‚´ãƒªãƒ¼ ï¼š ${getRadio('q11') || 'ï¼ˆæœªé¸æŠï¼‰'}

ã€ç¬¬5ãƒ–ãƒ­ãƒƒã‚¯ï¼šæœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ â€” Oï¼šã‚¢ã‚¦ãƒˆã‚«ãƒ ã€‘
Q12. æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ  ï¼š ${q12}
Q13. å®šé‡çš„ãªäºˆæ¸¬    ï¼š
${getVal('q13') || 'ï¼ˆæœªè¨˜å…¥ï¼‰'}
Q14. æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«    ï¼š â€»å‚è€ƒè³‡æ–™ã¯ã“ã®ãƒ¡ãƒ¼ãƒ«ã«ç›´æ¥æ·»ä»˜ã—ã¦ãã ã•ã„

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
`.trim();
}

// ============================================================
//  PICOéª¨æ ¼ã®è‡ªå‹•ç”Ÿæˆ
// ============================================================
function buildPico() {
  const p    = getRadio('q4')            || '___';
  const freq = getRadio('q5')            || '___';
  const pain = getQ6Values().join('ãƒ»')  || '___';
  const i    = getVal('q10')             || '___ï¼ˆã‚¢ã‚¤ãƒ‡ã‚¢ï¼‰';
  const c    = getVal('q8')              || '___ï¼ˆç¾åœ¨ã®å¯¾å¿œï¼‰';
  const o    = getQ12Values().join('ãƒ»') || '___';
  const q    = getVal('q13')             || 'ï¼ˆå®šé‡å€¤æœªè¨˜å…¥ï¼‰';
  return `
<b>Pï¼ˆå¯¾è±¡ãƒ»èƒŒæ™¯ï¼‰ï¼š</b>${p}ã«ãŠã„ã¦ã€${pain}ã¨ã„ã†å•é¡ŒãŒ${freq}ã®é »åº¦ã§ç™ºç”Ÿã—ã¦ã„ã‚‹ã€‚<br>
<b>Cï¼ˆæ¯”è¼ƒå¯¾ç…§ï¼‰ï¼š</b>ç¾åœ¨ã¯ã€Œ${c}ã€ã§å¯¾å¿œã—ã¦ã„ã‚‹ãŒã€æ ¹æœ¬çš„ãªè§£æ±ºã«ã¯è‡³ã£ã¦ã„ãªã„ã€‚<br>
<b>Iï¼ˆä»‹å…¥ï¼‰ï¼š</b>æ–°ãŸã«ã€Œ${i.substring(0,60)}â€¦ã€ã‚’å°å…¥ã™ã‚‹ã€‚<br>
<b>Oï¼ˆè©•ä¾¡é …ç›®ï¼‰ï¼š</b>${o}ã‚’ä¸»è¦è©•ä¾¡é …ç›®ã¨ã—ã€${q}ã®æ”¹å–„ãŒå¾—ã‚‰ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
`.trim();
}

// ============================================================
//  ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
// ============================================================
function showPreview() {
  if (!validate()) return;
  document.getElementById('previewText').textContent = buildText();
  document.getElementById('picoContent').innerHTML = buildPico();
  document.getElementById('picoBox').style.display = 'block';
  document.getElementById('previewModal').classList.add('active');
}

// ============================================================
//  â–¼â–¼â–¼ ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ã‚‹å‡¦ç†ï¼ˆå¤‰æ›´ç®‡æ‰€ï¼‰â–¼â–¼â–¼
// ============================================================

// ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã€Œâœ– é–‰ã˜ã‚‹ã€â†’ æ„Ÿè¬ãƒ¢ãƒ¼ãƒ€ãƒ«ã¸é·ç§»
function closePreviewAndThank() {
  document.getElementById('previewModal').classList.remove('active');
  // æ°åã‚’ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã—ã¦è¡¨ç¤º
  const name = getVal('q2');
  const label = (name && name !== 'åŒ¿å')
    ? `${name} ã•ã‚“ã€`
    : '';
  document.getElementById('thank-name-label').textContent = label;
  // æ„Ÿè¬ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
  document.getElementById('thankModal').classList.add('active');
}

// æ„Ÿè¬ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼šã€Œã“ã®ã¾ã¾é–‰ã˜ã‚‹ã€
function closeThankModal() {
  document.getElementById('thankModal').classList.remove('active');
}

// æ„Ÿè¬ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼šã€Œæ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ææ¡ˆã™ã‚‹ã€
function startNewIdea() {
  document.getElementById('thankModal').classList.remove('active');
  resetFormSilent(); // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãªã—ã§ãƒªã‚»ãƒƒãƒˆ
}

// â–²â–²â–² ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ã‚‹å‡¦ç†ã“ã“ã¾ã§ â–²â–²â–²

// ============================================================
//  ãƒ¡ãƒ¼ãƒ«é€ä¿¡
// ============================================================
function sendMail() {
  const dept = getVal('q1')   || 'ä¸æ˜';
  const name = getVal('q2')   || 'åŒ¿å';
  const cat  = getRadio('q11')|| 'æœªé¸æŠ';
  const subject = encodeURIComponent(`ã€é™¢å†…ã‚¢ã‚¤ãƒ‡ã‚¢ææ¡ˆã€‘${cat}ï½œ${dept} ${name}`);
  const body    = encodeURIComponent(
    buildText() + '\n\n' +
    '--- ç ”ç©¶è¨ˆç”»éª¨æ ¼ï¼ˆPICOï¼‰---\n' +
    buildPico().replace(/<[^>]+>/g, '') + '\n\n' +
    'â€»å‚è€ƒå†™çœŸãƒ»è³‡æ–™ãŒã‚ã‚‹å ´åˆã¯ã“ã®ãƒ¡ãƒ¼ãƒ«ã«ç›´æ¥æ·»ä»˜ã—ã¦ãã ã•ã„ã€‚'
  );
  window.location.href = `mailto:${MAIL_TO}?subject=${subject}&body=${body}`;
}

// ============================================================
//  TXTãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
// ============================================================
function downloadTxt() {
  const text = buildText() + '\n\n--- ç ”ç©¶è¨ˆç”»éª¨æ ¼ï¼ˆPICOï¼‰---\n' + buildPico().replace(/<[^>]+>/g, '');
  const now  = new Date();
  const ts   = `${now.getFullYear()}${String(now.getMonth()+1).padStart(2,'0')}${String(now.getDate()).padStart(2,'0')}`;
  const name = getVal('q2') || 'unknown';
  const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
  const a    = document.createElement('a');
  a.href     = URL.createObjectURL(blob);
  a.download = `idea_${ts}_${name}.txt`;
  a.click();
}

// ============================================================
//  ãƒªã‚»ãƒƒãƒˆ
// ============================================================
function resetFormSilent() {
  document.getElementById('ideaForm').reset();
  document.querySelectorAll('.feedback-box').forEach(el => { el.className = 'feedback-box'; el.textContent = ''; });
  document.querySelectorAll('.radio-group label, .check-group label').forEach(lbl => lbl.classList.remove('selected'));
  ['q6-other-wrap', 'q12-other-wrap'].forEach(id => {
    document.getElementById(id).classList.remove('show');
  });
  showStep(0);
  updateProgress();
}

function resetForm() {
  if (!confirm('âš ï¸ å…¥åŠ›å†…å®¹ã‚’ã™ã¹ã¦ã‚¯ãƒªã‚¢ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) return;
  resetFormSilent();
}

// åˆæœŸåŒ–
updateProgress();
</script>
</body>
</html>
